//@version=5
strategy("BlueDot Trading Strategy Template", shorttitle="BlueDot", overlay=true)

// Input Parameters
useBlueDotsSignals = input.bool(true, "Use Blue Dot Signals", group="Signal Settings")
useRLSTFilter = input.bool(true, "Use RLST Filter", group="Signal Settings")
useBCIndicator = input.bool(false, "Use BC Indicator", group="Signal Settings")

rlstThresholdBuy = input.int(80, "RLST Buy Threshold", minval=0, maxval=99, group="RLST Settings")
rlstThresholdSell = input.int(30, "RLST Sell Threshold", minval=0, maxval=99, group="RLST Settings")

bcThresholdBuy = input.float(25000, "BC Buy Threshold", group="BC Settings", tooltip="BC above this level indicates strong consolidation")
bcThresholdSell = input.float(20000, "BC Sell Threshold", group="BC Settings", tooltip="BC below this level indicates weakening consolidation")
bcTrendPeriod = input.int(5, "BC Trend Period", minval=3, maxval=20, group="BC Settings", tooltip="Bars to analyze BC trend")

// Data Access (Replace 'your_namespace' with your actual TradingView namespace)
blueDotSignal = request.seed('your_namespace', 'BLUE_DOTS', close)
rlstRating = request.seed('your_namespace', 'RLST_RATING', close)
bcIndicator = request.seed('your_namespace', 'BC_INDICATOR', close)

// BC Trend Analysis (time-aligned with price data)
bcStrengthening = bcIndicator > bcIndicator[bcTrendPeriod]  // BC improving over trend period
bcWeakening = bcIndicator < bcIndicator[bcTrendPeriod]      // BC declining over trend period
bcAboveThreshold = bcIndicator > bcThresholdBuy            // BC at strong consolidation level

// Signal Processing
isBlueDotsActive = useBlueDotsSignals ? blueDotSignal == 1 : true
isRLSTBullish = useRLSTFilter ? rlstRating > rlstThresholdBuy : true
isRLSTBearish = useRLSTFilter ? rlstRating < rlstThresholdSell : false
isBCBullish = useBCIndicator ? (bcAboveThreshold and bcStrengthening) : true
isBCBearish = useBCIndicator ? (bcIndicator < bcThresholdSell or bcWeakening) : false

// Entry Conditions
buyCondition = isBlueDotsActive and isRLSTBullish and isBCBullish
sellCondition = isRLSTBearish or isBCBearish

// Strategy Execution
if buyCondition and strategy.position_size == 0
    strategy.entry("Long", strategy.long, comment="BlueDot Buy")

if sellCondition and strategy.position_size > 0
    strategy.close("Long", comment="Exit")

// Visualization
plotshape(buyCondition, style=shape.triangleup, location=location.belowbar, 
          color=color.green, size=size.small, title="Buy Signal")
plotshape(sellCondition, style=shape.triangledown, location=location.abovebar, 
          color=color.red, size=size.small, title="Sell Signal")

// Plot BC trend
plot(bcIndicator, title="BC Indicator", color=bcStrengthening ? color.green : color.red, linewidth=1)
hline(bcThresholdBuy, "BC Buy Threshold", color=color.green, linestyle=hline.style_dashed)
hline(bcThresholdSell, "BC Sell Threshold", color=color.red, linestyle=hline.style_dashed)

// Info Panel
var table infoTable = table.new(position.top_right, 2, 6, bgcolor=color.white, border_width=1)
if barstate.islast
    table.cell(infoTable, 0, 0, "Blue Dot", text_color=color.black)
    table.cell(infoTable, 1, 0, str.tostring(blueDotSignal), text_color=blueDotSignal == 1 ? color.green : color.gray)
    
    table.cell(infoTable, 0, 1, "RLST", text_color=color.black)
    table.cell(infoTable, 1, 1, str.tostring(rlstRating, "#"), text_color=rlstRating > 50 ? color.green : color.red)
    
    table.cell(infoTable, 0, 2, "BC", text_color=color.black)
    table.cell(infoTable, 1, 2, str.tostring(bcIndicator, "#"), text_color=bcStrengthening ? color.green : color.red)
    
    table.cell(infoTable, 0, 3, "BC Trend", text_color=color.black)
    table.cell(infoTable, 1, 3, bcStrengthening ? "↗" : "↘", text_color=bcStrengthening ? color.green : color.red)
    
    table.cell(infoTable, 0, 4, "Position", text_color=color.black)
    table.cell(infoTable, 1, 4, strategy.position_size > 0 ? "Long" : "Flat", 
               text_color=strategy.position_size > 0 ? color.green : color.gray)